<!doctype html><html lang="en">
<head><meta charset="utf-8"><title>Route 100</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; line-height: 1.4; }
  .blocked {
    display:none; margin-top:16px; padding:12px 14px;
    border:1px solid #e5e5e5; border-radius:12px; background:#fafafa;
  }
  button {
    font-size:18px; padding:10px 14px; border-radius:12px;
    border:1px solid #ccc; cursor:pointer;
  }
  ol { margin-top: 12px; padding-left: 20px; }
  li { margin: 6px 0; }
  a { margin-left: 6px; }
  .note { margin-top:10px; color:#555; }
  #status { margin-top:10px; color:#333; }
</style>
<script>
const labels = ["Now — inbound", "Now — outbound", "2026-02-19 — inbound", "2026-02-19 — outbound", "2026-02-20 — inbound", "2026-02-20 — outbound", "2026-02-21 — inbound", "2026-02-21 — outbound", "2026-02-22 — inbound", "2026-02-22 — outbound", "2026-02-23 — inbound", "2026-02-23 — outbound", "2026-02-24 — inbound", "2026-02-24 — outbound", "2026-02-25 — inbound", "2026-02-25 — outbound", "2026-02-26 — inbound", "2026-02-26 — outbound", "2026-02-27 — inbound", "2026-02-27 — outbound", "2026-02-28 — inbound", "2026-02-28 — outbound", "2026-03-01 — inbound", "2026-03-01 — outbound", "2026-03-02 — inbound", "2026-03-02 — outbound", "2026-03-03 — inbound", "2026-03-03 — outbound", "This weekend — inbound", "This weekend — outbound"];
const urls = ["https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-19T00%3A00%3A00&endDate=2026-02-19T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-19T00%3A00%3A00&endDate=2026-02-19T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-20T00%3A00%3A00&endDate=2026-02-20T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-20T00%3A00%3A00&endDate=2026-02-20T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-21T00%3A00%3A00&endDate=2026-02-21T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-21T00%3A00%3A00&endDate=2026-02-21T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-22T00%3A00%3A00&endDate=2026-02-22T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-22T00%3A00%3A00&endDate=2026-02-22T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-23T00%3A00%3A00&endDate=2026-02-23T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-23T00%3A00%3A00&endDate=2026-02-23T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-24T00%3A00%3A00&endDate=2026-02-24T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-24T00%3A00%3A00&endDate=2026-02-24T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-25T00%3A00%3A00&endDate=2026-02-25T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-25T00%3A00%3A00&endDate=2026-02-25T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-26T00%3A00%3A00&endDate=2026-02-26T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-26T00%3A00%3A00&endDate=2026-02-26T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-27T00%3A00%3A00&endDate=2026-02-27T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-27T00%3A00%3A00&endDate=2026-02-27T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-02-28T00%3A00%3A00&endDate=2026-02-28T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-02-28T00%3A00%3A00&endDate=2026-02-28T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-03-01T00%3A00%3A00&endDate=2026-03-01T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-03-01T00%3A00%3A00&endDate=2026-03-01T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-03-02T00%3A00%3A00&endDate=2026-03-02T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-03-02T00%3A00%3A00&endDate=2026-03-02T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&dateTypeSelect=Future%20date&startDate=2026-03-03T00%3A00%3A00&endDate=2026-03-03T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&dateTypeSelect=Future%20date&startDate=2026-03-03T00%3A00%3A00&endDate=2026-03-03T23%3A59%3A59", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=inbound&startDate=2026-02-21T00%3A00%3A00&endDate=2026-02-22T23%3A59%3A59&dateTypeSelect=This%20weekend", "https://tfl.gov.uk/bus/status/?input=100&lineIds=100&direction=outbound&startDate=2026-02-21T00%3A00%3A00&endDate=2026-02-22T23%3A59%3A59&dateTypeSelect=This%20weekend"];
const delays = [0, 60, 200, 260, 550, 610, 900, 960, 1250, 1310, 1600, 1660, 1950, 2010, 2300, 2360, 2650, 2710, 3000, 3060, 3350, 3410, 3700, 3760, 4050, 4110, 4400, 4460, 4950, 5010];

let timeouts = [];

function clearSchedule() {
  for (const id of timeouts) clearTimeout(id);
  timeouts = [];
}

function setStatus(msg) {
  const el = document.getElementById("status");
  if (el) el.textContent = msg;
}

function renderPlannedList() {
  const ol = document.getElementById("plannedList");
  if (!ol) return;
  ol.innerHTML = "";
  for (let i = 0; i < labels.length; i++) {
    const li = document.createElement("li");

    const labelSpan = document.createElement("span");
    labelSpan.textContent = labels[i];

    const link = document.createElement("a");
    link.href = urls[i];
    link.target = "_blank";
    link.rel = "noopener";
    link.textContent = "open";

    li.appendChild(labelSpan);
    li.appendChild(document.createTextNode(" "));
    li.appendChild(link);
    ol.appendChild(li);
  }
}

function showFallback() {
  clearSchedule();
  const box = document.getElementById("blocked");
  box.style.display = "block";
  document.getElementById("tabCount").textContent = String(urls.length);
  renderPlannedList();
  setStatus("Popups are blocked. Allow popups for this site, then click “Open all tabs” to open everything in order.");

  document.getElementById("openAll").onclick = () => {
    setStatus("Checking popup permission…");
    // Must succeed on *this click* (user gesture). If blocked here, schedule will also fail.
    const test = window.open(urls[0]);
    if (!test) {
      setStatus("Still blocked. Allow popups for this site first — otherwise the browser will open 0–1 tab.");
      return;
    }

    setStatus("Popups allowed — opening tabs in order…");
    // We already opened index 0 in the permission test, so schedule the rest preserving spacing.
    scheduleFrom(1, delays[1] || 0);
  };
}

function scheduleFrom(startIdx, t0Delay) {
  for (let i = startIdx; i < urls.length; i++) {
    const d = Math.max(0, (delays[i] || 0) - t0Delay);
    const id = setTimeout(() => {
      const w = window.open(urls[i]);
      if (!w) {
        // If the browser starts blocking mid-stream, fall back immediately.
        showFallback();
      }
    }, d);
    timeouts.push(id);
  }
}

window.onload = function() {
  // Auto-open path (works when the site is allowed, like your original code).
  const w0 = window.open(urls[0]);
  if (!w0) {
    showFallback();
    return;
  }
  // Keep your intended timing for the rest.
  scheduleFrom(1, delays[1] || 0);
};
</script>
</head>
<body>
<p>
  Opening tabs for route 100.<br>
  • Now (inbound + outbound)<br>
  • Date range: 2026-02-19 → 2026-03-03 (inbound + outbound per day)<br>
  • This weekend (Sat 00:00 → Sun 23:59, London)
</p>

<div id="blocked" class="blocked">
  <strong>Popups are blocked for this site.</strong><br>
  Planned tabs: <span id="tabCount">?</span>.<br>
  Allow popups for this site <em>first</em>, then click “Open all tabs” to open everything in order.<br>
  Otherwise the browser may open only 0–1 tab.<br><br>

  <button id="openAll">Open all tabs</button>
  <div id="status"></div>

  <p class="note">
    Manual option (intended order):
  </p>
  <ol id="plannedList"></ol>

  <p class="note">
    Best experience: allow popups for this site to enable the one-click opener.
  </p>
</div>
</body>
</html>